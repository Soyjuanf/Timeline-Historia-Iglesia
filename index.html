<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Historia de la Iglesia – Línea de tiempo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- Montserrat -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --olive: #6b705c;
      --olive-dark: #4a4f3c;
      --terracotta: #b5654d;
      --terracotta-soft: rgba(181, 101, 77, 0.14);
      --bg: #f8f4f1;
      --bg-soft: #efe7df;
      --text: #2b2b2b;
      --white: #ffffff;
      --shadow-soft: 0 8px 20px rgba(0,0,0,0.18);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
    }

    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: 80px;
      background: var(--olive);
      color: var(--white);
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 0 24px;
      z-index: 20;
    }

    header h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 800;
      letter-spacing: 0.14em;
      text-transform: uppercase;
    }

    header span {
      font-size: 12px;
      opacity: 0.85;
    }

    main {
      position: absolute;
      inset: 80px 0 0 0;
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1fr);
      height: calc(100vh - 80px);
    }

    .timeline-wrapper {
      position: relative;
      overflow-x: auto;
      overflow-y: hidden;
      background: var(--bg-soft);
      scroll-behavior: smooth;
      padding-bottom: 24px;
    }

    .timeline-inner {
      display: flex;
      flex-direction: row;
      min-height: 100%;
    }

    .era {
      position: relative;
      min-width: 100vw;
      padding: 32px 32px 40px 32px;
      border-right: 1px solid rgba(0,0,0,0.08);
    }

    .era-header {
      text-transform: uppercase;
      letter-spacing: 0.14em;
      margin-bottom: 12px;
    }

    .era-title {
      font-weight: 800;
      font-size: 20px;
      color: var(--terracotta);
    }

    .era-subtitle {
      font-size: 11px;
      color: var(--olive-dark);
      opacity: 0.8;
      margin-top: 2px;
    }

    .era-body {
      margin-top: 24px;
    }

    .track {
      position: relative;
      margin: 0 72px;
    }

    .track-label {
      position: absolute;
      top: -14px;
      left: 0;
      transform: translateY(-100%);
      background: var(--white);
      padding: 3px 10px;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--olive-dark);
      z-index: 2;
    }

    .track-line {
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      border-top: 1px dashed rgba(0,0,0,0.18);
    }

    .track-content {
      position: relative;
      margin-top: 16px;
      padding-top: 8px;
      padding-bottom: 16px;
      min-height: 100px; /* base, luego JS la aumenta según filas */
    }

    .event {
      position: absolute;
      background: var(--white);
      border: 2px solid var(--terracotta);
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 11px;
      white-space: nowrap;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
      max-width: 360px;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .event:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-soft);
      border-color: var(--olive-dark);
    }

    .event--movement {
      background: var(--terracotta-soft);
      border-style: dashed;
    }

    /* Pastilla más amigable en móviles pequeños */
    @media (max-width: 480px) {
      .event {
        max-width: 260px;
        font-size: 10px;
        padding: 6px 10px;
      }
    }

    .ruler {
      position: relative;
      margin: 32px 72px 0 72px;
      padding-bottom: 12px;
    }

    .ruler-line {
      position: relative;
      height: 1px;
      background: rgba(0,0,0,0.22);
    }

    .ruler-tick {
      position: absolute;
      top: -4px;
      width: 1px;
      height: 9px;
      background: rgba(0,0,0,0.45);
    }

    .ruler-label {
      position: absolute;
      top: 10px;
      font-size: 10px;
      transform: translateX(-50%);
      color: rgba(0,0,0,0.7);
    }

    aside {
      background: var(--white);
      border-left: 1px solid rgba(0,0,0,0.08);
      padding: 24px 20px;
      overflow-y: auto;
    }

    aside h3 {
      margin-top: 0;
      font-weight: 800;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      font-size: 13px;
      color: var(--olive-dark);
    }

    .detail-card h4 {
      margin-top: 12px;
      margin-bottom: 8px;
      font-weight: 800;
      color: var(--terracotta);
    }

    .detail-card p {
      font-size: 13px;
      line-height: 1.6;
      margin-bottom: 12px;
    }

    .detail-card .tag {
      display: inline-block;
      font-size: 10px;
      border: 1px solid var(--olive);
      padding: 4px 8px;
      border-radius: 999px;
      margin-right: 6px;
      margin-bottom: 6px;
    }

    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
        grid-template-rows: minmax(0, 2.4fr) minmax(0, 1fr);
      }

      aside {
        border-left: none;
        border-top: 1px solid rgba(0,0,0,0.08);
        height: auto;
      }

      .timeline-wrapper {
        height: 100%;
      }

      .era {
        min-width: 120vw; /* un poco más ancha en móvil para dar aire */
      }
    }
  </style>
</head>

<body>
<header>
  <h1>HISTORIA DE LA IGLESIA</h1>
  <span>Línea de tiempo interactiva</span>
</header>

<main>
  <div class="timeline-wrapper">
    <div class="timeline-inner">

      <!-- Cada ERA se identifica por data-era para el script -->
      <section class="era" data-era="efeso">
        <div class="era-header">
          <div class="era-title">ÉFESO</div>
          <div class="era-subtitle">Apocalipsis 2:1–7 · Iglesia primitiva (0–200)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

      <section class="era" data-era="esmirna">
        <div class="era-header">
          <div class="era-title">ESMIRNA</div>
          <div class="era-subtitle">Apocalipsis 2:8–11 · Iglesia perseguida e imperial (200–300)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

      <section class="era" data-era="pergamo">
        <div class="era-header">
          <div class="era-title">PÉRGAMO</div>
          <div class="era-subtitle">Apocalipsis 2:12–17 · Iglesia imperial y mundanizada (300–400)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

      <section class="era" data-era="tiatira">
        <div class="era-header">
          <div class="era-title">TIATIRA</div>
          <div class="era-subtitle">Apocalipsis 2:18–29 · Iglesia medieval (400–1000)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

      <section class="era" data-era="sardis">
        <div class="era-header">
          <div class="era-title">SARDIS</div>
          <div class="era-subtitle">Apocalipsis 3:1–6 · Iglesia estatal y dividida (1100–1400)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

      <section class="era" data-era="filadelfia">
        <div class="era-header">
          <div class="era-title">FILADELFIA</div>
          <div class="era-subtitle">Apocalipsis 3:7–13 · Iglesia misionera (1500–1800)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

      <section class="era" data-era="laodicea">
        <div class="era-header">
          <div class="era-title">LAODICEA</div>
          <div class="era-subtitle">Apocalipsis 3:14–22 · Iglesia contemporánea (1900–2025)</div>
        </div>
        <div class="era-body">
          <div class="track" data-track="movements">
            <div class="track-label">MOVIMIENTOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="track" data-track="events">
            <div class="track-label">EVENTOS HISTÓRICOS</div>
            <div class="track-line"></div>
            <div class="track-content"></div>
          </div>

          <div class="ruler"></div>
        </div>
      </section>

    </div>
  </div>

  <aside>
    <h3>DETALLE</h3>
    <div id="detailPanel">
      Haz clic en un evento o movimiento para ver su información.
    </div>
  </aside>
</main>

<script>
  // Configuración de rangos por era (años)
  const ERA_RANGES = {
    efeso:      { start: 0,    end: 200 },
    esmirna:    { start: 200,  end: 300 },
    pergamo:    { start: 300,  end: 400 },
    tiatira:    { start: 400,  end: 1000 },
    sardis:     { start: 1100, end: 1400 },
    filadelfia: { start: 1500, end: 1800 },
    laodicea:   { start: 1900, end: 2025 }
  };

  // Datos: movimientos (rangos) y eventos (puntuales)
  const MOVEMENTS = [
    // Esmirna
    { era: 'esmirna', start: 156, end: 300,  title: 'Montanistas', description: 'Movimiento profético y rigorista surgido en Frigia, enfatizaba visiones y vida ascética.', tags:['Movimiento'] },
    { era: 'esmirna', start: 251, end: 400,  title: 'Novacianos', description: 'Grupo que negaba la readmisión de quienes habían apostatado en las persecuciones.', tags:['Movimiento'] },
    { era: 'esmirna', start: 311, end: 500,  title: 'Donatistas', description: 'Movimiento norteafricano que exigía pureza moral absoluta en los ministros.', tags:['Movimiento','África'] },
    { era: 'esmirna', start: 428, end: 600,  title: 'Nestorianos', description: 'Corriente cristológica asociada a Nestorio; se expande hacia Persia y Asia.', tags:['Movimiento'] },

    // Tiatira
    { era: 'tiatira', start: 900, end: 1100, title: 'Lombardos cristianos', description: 'Grupos de creyentes vinculados a la región lombarda con prácticas disidentes.', tags:['Remanente'] },
    { era: 'tiatira', start: 950, end: 1200, title: 'Paulicianos tardíos', description: 'Restos del movimiento pauliciano, de tradición oriental, con énfasis en la Biblia.', tags:['Movimiento'] },

    // Sardis
    { era: 'sardis', start: 1100, end: 1360, title: 'Albigenses / Cátaros', description: 'Movimientos disidentes en el sur de Francia que denunciaban la corrupción eclesial.', tags:['Movimiento','Francia'] },
    { era: 'sardis', start: 1415, end: 1450, title: 'Husitas', description: 'Seguidores de Jan Hus, precursor de la Reforma, activos en Bohemia.', tags:['Movimiento'] },

    // Filadelfia
    { era: 'filadelfia', start: 1517, end: 1564, title: 'Reforma: Lutero, Zwinglio, Calvino', description: 'Proceso de reforma doctrinal y eclesiástica en Alemania, Suiza y otros países.', tags:['Reforma'] },
    { era: 'filadelfia', start: 1525, end: 1700, title: 'Anabautistas y menonitas', description: 'Movimientos que enfatizan el bautismo de creyentes y una vida de discipulado radical.', tags:['Movimiento'] },

    // Laodicea
    { era: 'laodicea', start: 1900, end: 2025, title: 'Movimiento misionero moderno', description: 'Expansión de misiones mundiales, juntas misioneras y obra transcultural.', tags:['Misión'] }
  ];

  const EVENTS = [
    // ÉFESO 0–200
    { era:'efeso', year:29,  title:'Ministerio público de Jesús', description:'Jesús anuncia el Reino de Dios y forma a sus discípulos.', tags:['Evangelios'] },
    { era:'efeso', year:30,  title:'Crucifixión y resurrección de Jesús', description:'Muerte y resurrección de Cristo, fundamento de la fe cristiana.', tags:['Redención'] },
    { era:'efeso', year:43,  title:'Roma invade Bretaña', description:'Comienza la conquista romana de Bretaña.', tags:['Imperio romano'] },
    { era:'efeso', year:45,  title:'Se les llama cristianos en Antioquía', description:'Por primera vez los discípulos son llamados “cristianos”.', tags:['Identidad cristiana'] },
    { era:'efeso', year:50,  title:'Viajes misioneros de Pablo', description:'Pablo extiende el evangelio por Asia Menor y Europa.', tags:['Misión'] },
    { era:'efeso', year:64,  title:'Persecución de Nerón', description:'Nerón culpa a los cristianos del incendio de Roma.', tags:['Persecución'] },
    { era:'efeso', year:66,  title:'Primera guerra judío-romana', description:'Levantamiento judío contra Roma en Judea.', tags:['Historia','Judíos'] },
    { era:'efeso', year:67,  title:'Martirio del apóstol Pedro', description:'Según la tradición, Pedro muere martirizado en Roma.', tags:['Martirio'] },
    { era:'efeso', year:70,  title:'Destrucción de Jerusalén', description:'Las legiones romanas destruyen Jerusalén y el Templo.', tags:['Profecía cumplida'] },
    { era:'efeso', year:73,  title:'Caída de Masada', description:'Último bastión judío frente a Roma cae tras largo asedio.', tags:['Historia judía'] },
    { era:'efeso', year:79,  title:'Erupción del Vesubio', description:'Pompeya y Herculano son destruidas.', tags:['Catástrofe'] },
    { era:'efeso', year:80,  title:'Josefo escribe “La guerra de los judíos”', description:'Crónica clave del conflicto judeo-romano.', tags:['Historia'] },
    { era:'efeso', year:90,  title:'Persecución de Domiciano', description:'Domiciano persigue a cristianos por negarse a adorar al emperador.', tags:['Persecución'] },
    { era:'efeso', year:100, title:'Martirio de Clemente de Roma', description:'Uno de los primeros obispos de Roma es ejecutado.', tags:['Martirio'] },
    { era:'efeso', year:155, title:'Justino Mártir confronta a Marción', description:'Defensa de la fe apostólica frente a la herejía marcionita.', tags:['Apologética'] },
    { era:'efeso', year:170, title:'Marco Aurelio y los cristianos', description:'Durante su reinado se intensifican persecuciones locales.', tags:['Persecución'] },
    { era:'efeso', year:200, title:'Apología de Tertuliano', description:'Tertuliano redacta defensas formales del cristianismo.', tags:['Apologética'] },
    { era:'efeso', year:250, title:'Persecución de Decio', description:'Persecución imperial que exige sacrificios a los dioses.', tags:['Persecución'] },

    // ESMIRNA 200–300 (y algo más allá en la práctica histórica)
    { era:'esmirna', year:303, title:'Gran persecución de Diocleciano', description:'Intento sistemático de destruir la Iglesia en todo el Imperio.', tags:['Persecución'] },
    { era:'esmirna', year:311, title:'Historia Eclesiástica de Eusebio', description:'Primera gran historia formal de la Iglesia.', tags:['Historia de la Iglesia'] },
    { era:'esmirna', year:312, title:'Constantino gana la batalla del Puente Milvio', description:'Victoria de Constantino bajo el símbolo cristiano.', tags:['Constantino'] },
    { era:'esmirna', year:313, title:'Edicto de Milán', description:'Se concede libertad religiosa a los cristianos.', tags:['Iglesia y Estado'] },
    { era:'esmirna', year:325, title:'Concilio de Nicea', description:'Primer concilio ecuménico; se afirma la divinidad de Cristo.', tags:['Concilios'] },
    { era:'esmirna', year:340, title:'Cristianismo llega a Abisinia', description:'La fe llega a Etiopía por obra de misioneros.', tags:['Misión'] },
    { era:'esmirna', year:361, title:'Juliano el Apóstata', description:'Emperador que intenta restaurar el paganismo.', tags:['Imperio'] },
    { era:'esmirna', year:370, title:'Basilio contra el arrianismo', description:'Defiende la doctrina trinitaria frente al arrianismo.', tags:['Teología'] },
    { era:'esmirna', year:380, title:'Cristianismo religión oficial del Imperio', description:'Con el edicto de Tesalónica el cristianismo niceno se vuelve oficial.', tags:['Iglesia y Estado'] },
    { era:'esmirna', year:395, title:'División del Imperio romano', description:'El Imperio se reparte en Oriente y Occidente.', tags:['Imperio romano'] },
    { era:'esmirna', year:396, title:'Agustín obispo de Hipona', description:'Inicio del ministerio episcopal de Agustín.', tags:['Teología'] },
    { era:'esmirna', year:405, title:'Jerónimo termina la Vulgata', description:'Traducción latina de la Biblia usada por siglos.', tags:['Biblia'] },
    { era:'esmirna', year:431, title:'Se afirma el título “Madre de Dios”', description:'El concilio de Éfeso proclama a María como Theotokos.', tags:['Mariología'] },
    { era:'esmirna', year:436, title:'Tropas romanas abandonan Britania', description:'Fin de la presencia militar romana en Britania.', tags:['Historia'] },
    { era:'esmirna', year:443, title:'Pueblos germánicos en Alsacia', description:'Asentamientos bárbaros permanentes en territorio romano.', tags:['Invasiones'] },
    { era:'esmirna', year:450, title:'León I y el rol del papado', description:'El papa León I media frente a invasiones y afirma la autoridad papal.', tags:['Papado'] },
    { era:'esmirna', year:452, title:'Atila el Huno invade Italia', description:'León I negocia con Atila para detener el saqueo de Roma.', tags:['Invasiones'] },
    { era:'esmirna', year:455, title:'Los vándalos saquean Roma', description:'Saqueo que evidencia la debilidad del Imperio.', tags:['Caída de Roma'] },
    { era:'esmirna', year:470, title:'Florece la civilización maya clásica', description:'Apogeo de ciudades-estado en Mesoamérica.', tags:['Culturas antiguas'] },
    { era:'esmirna', year:476, title:'Último emperador romano de Occidente', description:'Depuesto Rómulo Augústulo.', tags:['Caída de Roma'] },
    { era:'esmirna', year:478, title:'Primer templo sintoísta en Japón', description:'Consolidación del sintoísmo en Japón.', tags:['Religiones del mundo'] },

    // TIATIRA 400–1000
    { era:'tiatira', year:532, title:'Construcción de Santa Sofía', description:'Justinianismo: iglesia monumental en Constantinopla.', tags:['Bizancio'] },
    { era:'tiatira', year:568, title:'Lombardos invaden Italia', description:'Un nuevo pueblo germánico entra en la península.', tags:['Invasiones'] },
    { era:'tiatira', year:570, title:'Nacimiento de Mahoma', description:'Fundador del islam en La Meca.', tags:['Islam'] },
    { era:'tiatira', year:622, title:'Hégira de Mahoma', description:'Huida de Mahoma a Medina; inicio oficial del calendario islámico.', tags:['Islam'] },
    { era:'tiatira', year:622, title:'Impresión de libros en China', description:'Primeros usos de impresión con bloques de madera.', tags:['China'] },
    { era:'tiatira', year:640, title:'Musulmanes conquistan el Medio Oriente', description:'Rápida expansión árabe-islámica.', tags:['Islam'] },
    { era:'tiatira', year:643, title:'Construcción de la Cúpula de la Roca', description:'Santuario islámico en Jerusalén.', tags:['Islam','Jerusalén'] },
    { era:'tiatira', year:715, title:'Árabes entran a España y Portugal', description:'Inicio del dominio musulmán en la península ibérica.', tags:['Islam','Europa'] },
    { era:'tiatira', year:732, title:'Batalla de Tours', description:'Carlos Martel frena el avance musulmán en Francia.', tags:['Guerras'] },
    { era:'tiatira', year:730, title:'Beda escribe Historia Eclesiástica', description:'Crónica de la Iglesia en Inglaterra.', tags:['Historia de la Iglesia'] },
    { era:'tiatira', year:725, title:'Controversia de los iconoclastas', description:'Debate sobre el uso de imágenes en el culto.', tags:['Teología','Iconoclasia'] },
    { era:'tiatira', year:790, title:'Vikingos invaden Europa', description:'Oleadas de incursiones escandinavas.', tags:['Invasiones'] },
    { era:'tiatira', year:796, title:'Alcuino revisa la Vulgata', description:'Trabajo textual en el Renacimiento carolingio.', tags:['Biblia'] },
    { era:'tiatira', year:800, title:'Carlomagno coronado emperador', description:'Renovación del título imperial en Occidente.', tags:['Imperio','Papa'] },
    { era:'tiatira', year:962, title:'Otón I el Grande', description:'Consolidación del Sacro Imperio Romano Germánico.', tags:['Imperio'] },
    { era:'tiatira', year:979, title:'China unificada bajo la dinastía Song', description:'Importante florecimiento cultural.', tags:['China'] },
    { era:'tiatira', year:1000, title:'Cumbre de la civilización maya en Yucatán', description:'Apogeo tardío en la península de Yucatán.', tags:['Culturas antiguas'] },
    { era:'tiatira', year:1054, title:'Gran Cisma de Oriente y Occidente', description:'Separación formal entre Iglesias de Constantinopla y Roma.', tags:['Cisma'] },
    { era:'tiatira', year:1066, title:'Guillermo el Conquistador, rey de Inglaterra', description:'Conquista normanda de Inglaterra.', tags:['Historia'] },

    // SARDIS 1100–1400
    { era:'sardis', year:1096, title:'Primera Cruzada', description:'Expedición para recuperar Tierra Santa.', tags:['Cruzadas'] },
    { era:'sardis', year:1147, title:'Segunda Cruzada', description:'Nueva campaña hacia Oriente.', tags:['Cruzadas'] },
    { era:'sardis', year:1188, title:'Tercera Cruzada', description:'Cruzada de Ricardo Corazón de León y otros reyes.', tags:['Cruzadas'] },
    { era:'sardis', year:1202, title:'Cuarta Cruzada', description:'Desviada hacia Constantinopla, debilita el Imperio bizantino.', tags:['Cruzadas'] },
    { era:'sardis', year:1150, title:'Universidades de Oxford y París', description:'Nacen centros de estudio teológico y filosófico.', tags:['Universidades'] },
    { era:'sardis', year:1170, title:'Asesinato de Tomás Becket', description:'Conflicto entre Iglesia y corona inglesa.', tags:['Martirio'] },
    { era:'sardis', year:1215, title:'Carta Magna', description:'Límite al poder real en Inglaterra.', tags:['Historia política'] },
    { era:'sardis', year:1215, title:'Transubstanciación definida', description:'El IV Concilio de Letrán formula la doctrina de la transubstanciación.', tags:['Dogma'] },
    { era:'sardis', year:1265, title:'Tomás de Aquino – Suma Teológica', description:'Síntesis magistral de teología escolástica.', tags:['Teología'] },
    { era:'sardis', year:1266, title:'Nacimiento del pintor Giotto', description:'Pionero del arte pre-renacentista.', tags:['Arte'] },
    { era:'sardis', year:1384, title:'Biblia de Wycliffe', description:'Traducción de la Biblia al inglés medio.', tags:['Biblia','Reforma temprana'] },
    { era:'sardis', year:1415, title:'Martirio de Jan Hus', description:'Reformador bohemio quemado en la hoguera.', tags:['Reforma temprana'] },
    { era:'sardis', year:1418, title:'Tomás de Kempis – Imitación de Cristo', description:'Obra devocional influyente.', tags:['Espiritualidad'] },
    { era:'sardis', year:1440, title:'Gutenberg introduce la imprenta', description:'Revoluciona la difusión de libros.', tags:['Imprenta'] },
    { era:'sardis', year:1453, title:'Caída de Constantinopla', description:'Fin del Imperio bizantino a manos de los turcos.', tags:['Historia'] },
    { era:'sardis', year:1479, title:'Inquisición española', description:'Consolidación de la Inquisición en España.', tags:['Inquisición'] },
    { era:'sardis', year:1494, title:'Savonarola y la inmoralidad papal', description:'Predicador dominico que denuncia el pecado en Florencia.', tags:['Reforma temprana'] },

    // FILADELFIA 1500–1800
    { era:'filadelfia', year:1516, title:'Nuevo Testamento de Erasmo', description:'Edición crítica en griego que impulsa la Reforma y traducciones bíblicas.', tags:['Biblia'] },
    { era:'filadelfia', year:1530, title:'Iglesia luterana', description:'Consolidación de las iglesias luteranas en Alemania y Escandinavia.', tags:['Reforma'] },
    { era:'filadelfia', year:1541, title:'Iglesia congregacionalista', description:'Formación de iglesias autónomas con gobierno congregacional.', tags:['Reforma'] },
    { era:'filadelfia', year:1568, title:'Derrota de la Armada española', description:'Fracaso de la flota española contra Inglaterra.', tags:['Historia'] },
    { era:'filadelfia', year:1572, title:'Masacre de San Bartolomé', description:'Matanzas de hugonotes en Francia.', tags:['Conflictos religiosos'] },
    { era:'filadelfia', year:1603, title:'Iglesia presbiteriana', description:'Impulso del presbiterianismo escocés.', tags:['Reforma'] },
    { era:'filadelfia', year:1629, title:'Descartes y el racionalismo', description:'Inicio formal del racionalismo moderno.', tags:['Filosofía'] },
    { era:'filadelfia', year:1665, title:'Newton y la gravedad', description:'Experimentos que llevan a la teoría de la gravitación.', tags:['Ciencia'] },
    { era:'filadelfia', year:1569, title:'Biblia del Oso', description:'Primera traducción completa de la Biblia al castellano protestante.', tags:['Biblia'] },
    { era:'filadelfia', year:1700, title:'Misioneros y avivamientos', description:'Obra de Edwards, Whitefield, Wesley, Brainerd, Carey, Judson, etc.', tags:['Avivamiento','Misión'] },
    { era:'filadelfia', year:1859, title:'Darwin publica “El origen de las especies”', description:'La teoría de la evolución provoca debates intensos con la fe cristiana.', tags:['Ciencia'] },

    // LAODICEA 1900–2025
    { era:'laodicea', year:1914, title:'Primera Guerra Mundial', description:'Conflicto global que marca el siglo XX.', tags:['Guerras mundiales'] },
    { era:'laodicea', year:1939, title:'Segunda Guerra Mundial', description:'Guerra global con profundo impacto geopolítico y religioso.', tags:['Guerras mundiales'] },
    { era:'laodicea', year:1948, title:'Fundación del Estado de Israel', description:'Restablecimiento de un Estado judío en Palestina.', tags:['Israel'] },
    { era:'laodicea', year:1950, title:'Ministerio de Billy Graham', description:'Evangelista mundial que predica a millones.', tags:['Evangelismo'] },
    { era:'laodicea', year:1960, title:'Movimientos carismáticos y misiones globales', description:'Expansión de iglesias pentecostales y carismáticas.', tags:['Movimiento moderno'] },
    { era:'laodicea', year:1980, title:'Martyn Lloyd-Jones, predicación expositiva', description:'Influencia en la recuperación de la predicación bíblica.', tags:['Predicación'] },
    { era:'laodicea', year:2000, title:'Iglesia en el mundo digital', description:'Uso masivo de medios y tecnologías en la vida de la Iglesia.', tags:['Tecnología','Iglesia'] }
  ];

  const detailPanel = document.getElementById('detailPanel');

  function yearToPercent(year, eraId) {
    const range = ERA_RANGES[eraId];
    const span = range.end - range.start;
    return ((year - range.start) / span) * 100;
  }

  function renderRulers() {
    document.querySelectorAll('.era').forEach(eraEl => {
      const eraId = eraEl.dataset.era;
      const range = ERA_RANGES[eraId];
      const rulerContainer = eraEl.querySelector('.ruler');

      const line = document.createElement('div');
      line.className = 'ruler-line';
      rulerContainer.appendChild(line);

      const step = 50;
      const firstTick = Math.ceil(range.start / step) * step;

      for (let y = firstTick; y <= range.end; y += step) {
        const percent = yearToPercent(y, eraId);
        const tick = document.createElement('div');
        tick.className = 'ruler-tick';
        tick.style.left = percent + '%';

        const label = document.createElement('div');
        label.className = 'ruler-label';
        label.style.left = percent + '%';
        label.textContent = y;

        rulerContainer.appendChild(tick);
        rulerContainer.appendChild(label);
      }
    });
  }

  function createEventElement(data, kind) {
    const el = document.createElement('div');
    el.className = 'event' + (kind === 'movement' ? ' event--movement' : '');
    const label = kind === 'movement'
      ? `${data.start}–${data.end} · ${data.title}`
      : `${data.year} · ${data.title}`;
    el.textContent = label;

    el.dataset.kind = kind;
    el.dataset.era = data.era;
    el.dataset.year = kind === 'movement' ? data.start : data.year;
    el.dataset.startYear = kind === 'movement' ? data.start : data.year;
    el.dataset.endYear = kind === 'movement' ? data.end : data.year;

    el.addEventListener('click', () => {
      const tagsHtml = (data.tags || [])
        .map(t => `<span class="tag">${t}</span>`)
        .join('');
      detailPanel.innerHTML = `
        <div class="detail-card">
          <h4>${data.title}</h4>
          <p>${data.description || ''}</p>
          <div>${tagsHtml}</div>
        </div>
      `;
    });

    return el;
  }

  function renderEventsAndMovements() {
    const eras = document.querySelectorAll('.era');

    eras.forEach(eraEl => {
      const eraId = eraEl.dataset.era;
      const tracks = {
        movements: eraEl.querySelector('.track[data-track="movements"] .track-content'),
        events: eraEl.querySelector('.track[data-track="events"] .track-content')
      };

      // movimientos
      MOVEMENTS.filter(m => m.era === eraId).forEach(mov => {
        const el = createEventElement(mov, 'movement');
        const percent = yearToPercent(mov.start, eraId);
        el.style.left = percent + '%'; // borde izquierdo sobre el año (visual)
        tracks.movements.appendChild(el);
      });

      // eventos puntuales
      EVENTS.filter(ev => ev.era === eraId).forEach(ev => {
        const el = createEventElement(ev, 'event');
        const percent = yearToPercent(ev.year, eraId);
        el.style.left = percent + '%';
        tracks.events.appendChild(el);
      });
    });
  }

  // Distribución vertical robusta por "lanes" sin solaparse
  function layoutTracks() {
    const LANE_GAP = 54;   // más separación vertical entre filas
    const MIN_X_GAP = 10;  // separación mínima horizontal entre pastillas

    document.querySelectorAll('.era').forEach(eraEl => {
      ['movements', 'events'].forEach(trackType => {
        const content = eraEl.querySelector(
          `.track[data-track="${trackType}"] .track-content`
        );
        const items = Array.from(content.querySelectorAll('.event'));
        if (!items.length) return;

        // Orden por año de inicio
        items.sort((a, b) =>
          Number(a.dataset.startYear) - Number(b.dataset.startYear)
        );

        const lanes = []; // cada lane guarda último endX (local) usado
        const baseRect = content.getBoundingClientRect();

        items.forEach(el => {
          const rect = el.getBoundingClientRect();
          const startX = rect.left - baseRect.left;
          const endX   = rect.right - baseRect.left;

          let laneIndex = 0;
          while (true) {
            if (lanes[laneIndex] === undefined || startX - lanes[laneIndex] > MIN_X_GAP) {
              lanes[laneIndex] = endX;
              break;
            }
            laneIndex++;
          }

          const top = laneIndex * LANE_GAP;
          el.style.top = top + 'px';
        });

        const usedHeight = lanes.length * LANE_GAP;
        content.style.minHeight = (usedHeight + 32) + 'px';
      });
    });
  }

  function initTimeline() {
    renderRulers();
    renderEventsAndMovements();
    // un frame para que el navegador calcule tamaños
    requestAnimationFrame(() => {
      layoutTracks();
    });
  }

  window.addEventListener('load', initTimeline);
</script>

</body>
</html>
