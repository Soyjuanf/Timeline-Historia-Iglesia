<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Historia de la Iglesia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- Montserrat -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap"
    rel="stylesheet">

  <style>
    :root {
      --olive: #6b705c;
      --olive-dark: #4a4f3c;
      --terracotta: #b5654d;
      --terracotta-soft: rgba(181,101,77,0.12);
      --bg: #f8f4f1;
      --text: #2b2b2b;
      --white: #ffffff;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
    }

    header {
      position: fixed;
      inset: 0 0 auto 0;
      height: 72px;
      background: var(--olive);
      color: var(--white);
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 0 20px;
      z-index: 20;
    }

    header h1 {
      margin: 0;
      font-size: 18px;
      font-weight: 800;
      letter-spacing: 0.14em;
      text-transform: uppercase;
    }

    header span {
      font-size: 11px;
      opacity: 0.8;
    }

    main {
      position: absolute;
      inset: 72px 0 0 0;
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1fr);
      max-height: calc(100vh - 72px);
    }

    .timeline-wrapper {
      overflow-x: auto;
      overflow-y: hidden;
      display: flex;
      scroll-snap-type: x mandatory;
      background: #efe9e4;
    }

    .era {
      scroll-snap-align: start;
      min-width: 140vw;
      padding: 28px 32px 40px;
      border-right: 1px solid rgba(0,0,0,0.08);
      position: relative;
    }

    .era-title {
      font-size: 20px;
      font-weight: 800;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--terracotta);
      margin-bottom: 4px;
    }

    .era-subtitle {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--olive-dark);
      opacity: 0.85;
    }

    .layers {
      margin-top: 40px;
      display: grid;
      grid-template-rows: 210px 260px;
      row-gap: 40px;
      position: relative;
    }

    .layer {
      position: relative;
      padding: 0 260px;
    }

    .layer::before {
      content: "";
      position: absolute;
      left: 260px;
      right: 260px;
      top: 50%;
      border-top: 1px dashed rgba(0,0,0,0.22);
    }

    .layer-label {
      position: absolute;
      left: 50%;
      top: -10px;
      transform: translateX(-50%);
      background: var(--bg);
      padding: 2px 14px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--olive-dark);
    }

    .ruler {
      position: absolute;
      left: 260px;
      right: 260px;
      bottom: 6px;
      height: 22px;
      border-top: 1px solid rgba(0,0,0,0.28);
    }

    .ruler-tick {
      position: absolute;
      bottom: 0;
      width: 1px;
      height: 7px;
      background: rgba(0,0,0,0.35);
      transform: translateX(-50%);
      font-size: 9px;
      text-align: center;
    }

    .ruler-tick span {
      position: absolute;
      top: 7px;
      left: 50%;
      transform: translateX(-50%);
      white-space: nowrap;
      color: rgba(0,0,0,0.6);
    }

    .event {
      position: absolute;
      left: 0;
      top: 0;
      transform: translate(-50%, -50%);
      background: var(--white);
      border-radius: 999px;
      border: 2px solid var(--terracotta);
      padding: 7px 16px;
      font-size: 11px;
      white-space: nowrap;
      cursor: pointer;
      transition: box-shadow 0.23s ease, transform 0.23s ease, border-color 0.23s ease;
    }

    .event:hover {
      box-shadow: 0 10px 26px rgba(0,0,0,0.22);
      transform: translate(-50%, -50%) scale(1.06);
      border-color: var(--olive-dark);
      z-index: 5;
    }

    .event--movement {
      background: var(--terracotta-soft);
      border-style: dashed;
      border-width: 2px;
      border-color: var(--terracotta);
      border-radius: 24px;
    }

    .event--movement:hover {
      background: rgba(181,101,77,0.18);
    }

    aside {
      background: var(--white);
      padding: 22px 22px 12px;
      border-left: 1px solid rgba(0,0,0,0.08);
      overflow-y: auto;
      max-height: calc(100vh - 72px);
    }

    aside h3 {
      margin-top: 0;
      font-size: 14px;
      font-weight: 800;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--olive-dark);
      margin-bottom: 12px;
    }

    .detail-card h4 {
      margin: 10px 0 6px;
      font-size: 15px;
      font-weight: 800;
      color: var(--terracotta);
    }

    .detail-card p {
      font-size: 13px;
      line-height: 1.6;
      margin: 0 0 10px;
    }

    .detail-card .tag {
      display: inline-block;
      font-size: 10px;
      border-radius: 999px;
      border: 1px solid var(--olive);
      padding: 3px 7px;
      margin: 0 4px 4px 0;
    }

    /* MOBILE */
    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
        grid-template-rows: minmax(0, 70vh) minmax(0, 30vh);
      }

      aside {
        border-left: none;
        border-top: 1px solid rgba(0,0,0,0.08);
        max-height: none;
      }

      .timeline-wrapper {
        height: 100%;
      }

      .era {
        min-width: 180vw;
        padding-inline: 18px;
      }

      .layer {
        padding-inline: 120px;
      }

      .layer::before {
        left: 120px;
        right: 120px;
      }

      .ruler {
        left: 120px;
        right: 120px;
      }
    }
  </style>
</head>

<body>
<header>
  <h1>HISTORIA DE LA IGLESIA</h1>
  <span>Línea de tiempo interactiva</span>
</header>

<main>
  <div class="timeline-wrapper" id="timeline">
    <!-- Cada era tiene start / end absolutos -->
    <section class="era" data-era="efeso" data-start="0" data-end="200">
      <div class="era-title">ÉFESO</div>
      <div class="era-subtitle">Apocalipsis 2:1–7 · Iglesia primitiva</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>

    <section class="era" data-era="esmirna" data-start="200" data-end="300">
      <div class="era-title">ESMIRNA</div>
      <div class="era-subtitle">Apocalipsis 2:8–11 · Iglesia perseguida e imperial</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>

    <section class="era" data-era="pergamo" data-start="300" data-end="400">
      <div class="era-title">PÉRGAMO</div>
      <div class="era-subtitle">Apocalipsis 2:12–17 · Iglesia imperial y mundanizada</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>

    <section class="era" data-era="tiatira" data-start="400" data-end="1000">
      <div class="era-title">TIATIRA</div>
      <div class="era-subtitle">Apocalipsis 2:18–29 · Iglesia medieval</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>

    <section class="era" data-era="sardis" data-start="1100" data-end="1400">
      <div class="era-title">SARDIS</div>
      <div class="era-subtitle">Apocalipsis 3:1–6 · Iglesia reformada pero muerta</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>

    <section class="era" data-era="filadelfia" data-start="1500" data-end="1800">
      <div class="era-title">FILADELFIA</div>
      <div class="era-subtitle">Apocalipsis 3:7–13 · Iglesia misionera</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>

    <section class="era" data-era="laodicea" data-start="1900" data-end="2025">
      <div class="era-title">LAODICEA</div>
      <div class="era-subtitle">Apocalipsis 3:14–22 · Iglesia tibia contemporánea</div>
      <div class="layers">
        <div class="layer layer--movements">
          <div class="layer-label">MOVIMIENTOS</div>
        </div>
        <div class="layer layer--events">
          <div class="layer-label">EVENTOS HISTÓRICOS</div>
        </div>
      </div>
      <div class="ruler"></div>
    </section>
  </div>

  <aside>
    <h3>DETALLE</h3>
    <div id="detailPanel">Haz clic en un evento para ver su información.</div>
  </aside>
</main>

<script>
  // ---------- DATA ----------
  // type: "point" (evento puntual) o "movement" (banda de duración)
  // year / startYear / endYear son años ABSOLUTOS (no relativos)

  const events = [
    // === ÉFESO 0–200 ===
    { era: "efeso", type: "point", year: 29,
      title: "Ministerio público de Jesús",
      description: "Jesús anuncia el Reino de Dios y forma a sus discípulos.",
      tags: ["Evangelios"] },
    { era: "efeso", type: "point", year: 30,
      title: "Crucifixión y resurrección",
      description: "Muerte y resurrección de Jesús en Jerusalén.",
      tags: ["Redención"] },
    { era: "efeso", type: "point", year: 43,
      title: "Roma invade Bretaña",
      description: "Claudio inicia la conquista romana de Bretaña.",
      tags: ["Imperio romano"] },
    { era: "efeso", type: "point", year: 45,
      title: "Se les llama cristianos en Antioquía",
      description: "Por primera vez los discípulos reciben el nombre de cristianos.",
      tags: ["Identidad cristiana"] },
    { era: "efeso", type: "point", year: 50,
      title: "Viajes misioneros de Pablo",
      description: "Pablo recorre Asia Menor y Europa predicando el evangelio.",
      tags: ["Misión"] },
    { era: "efeso", type: "point", year: 64,
      title: "Persecución de Nerón",
      description: "Nerón culpa a los cristianos del incendio de Roma.",
      tags: ["Persecución"] },
    { era: "efeso", type: "point", year: 66,
      title: "Primera guerra judío-romana",
      description: "Rebelión judía contra Roma en Judea.",
      tags: ["Historia"] },
    { era: "efeso", type: "point", year: 67,
      title: "Martirio del apóstol Pedro",
      description: "Tradicionalmente se ubica en Roma durante el gobierno de Nerón.",
      tags: ["Martirio"] },
    { era: "efeso", type: "point", year: 70,
      title: "Destrucción de Jerusalén",
      description: "Tito destruye la ciudad y el templo.",
      tags: ["Profecía cumplida"] },
    { era: "efeso", type: "point", year: 73,
      title: "Caída de Masada",
      description: "Último bastión judío frente a Roma.",
      tags: ["Historia judía"] },
    { era: "efeso", type: "point", year: 79,
      title: "Erupción del Vesubio",
      description: "Pompeya y Herculano quedan sepultadas por ceniza volcánica.",
      tags: ["Catástrofe"] },
    { era: "efeso", type: "point", year: 80,
      title: "Josefo escribe 'La guerra de los judíos'",
      description: "Relato de la rebelión judía contra Roma.",
      tags: ["Historia"] },
    { era: "efeso", type: "point", year: 90,
      title: "Persecución de Domiciano",
      description: "Domiciano exige culto imperial; crecen los martirios.",
      tags: ["Persecución"] },
    { era: "efeso", type: "point", year: 100,
      title: "Martirio de Clemente de Roma",
      description: "Tradición que ubica su muerte en el exilio.",
      tags: ["Padres apostólicos"] },

    // === ESMIRNA 200–300 ===
    { era: "esmirna", type: "movement", startYear: 170, endYear: 300,
      title: "Montanistas",
      description: "Movimiento profético rigorista surgido en Frigia.",
      tags: ["Movimiento", "Profecía"] },
    { era: "esmirna", type: "movement", startYear: 251, endYear: 400,
      title: "Novacianos",
      description: "Defienden disciplina extrema hacia apóstatas.",
      tags: ["Movimiento", "Rigorismo"] },
    { era: "esmirna", type: "movement", startYear: 311, endYear: 500,
      title: "Donatistas",
      description: "En el norte de África, ligan la validez de los sacramentos a la pureza del ministro.",
      tags: ["Movimiento", "África"] },
    { era: "esmirna", type: "movement", startYear: 428, endYear: 600,
      title: "Nestorianos",
      description: "Corriente cristológica asociada a Nestorio; se extiende hacia Persia y Asia.",
      tags: ["Movimiento", "Cristología"] },

    { era: "esmirna", type: "point", year: 303,
      title: "Gran persecución de Diocleciano",
      description: "Intento sistemático de destruir la Iglesia.",
      tags: ["Persecución"] },
    { era: "esmirna", type: "point", year: 311,
      title: "Historia eclesiástica de Eusebio",
      description: "Primera gran historia oficial de la Iglesia.",
      tags: ["Historia de la Iglesia"] },
    { era: "esmirna", type: "point", year: 312,
      title: "Constantino gana el Puente Milvio",
      description: "Victoria decisiva bajo el símbolo cristiano.",
      tags: ["Constantino"] },
    { era: "esmirna", type: "point", year: 313,
      title: "Edicto de Milán",
      description: "Se otorga libertad religiosa a los cristianos.",
      tags: ["Iglesia y Estado"] },
    { era: "esmirna", type: "point", year: 325,
      title: "Concilio de Nicea",
      description: "Se afirma la plena divinidad de Cristo, contra Arrio.",
      tags: ["Concilios"] },
    { era: "esmirna", type: "point", year: 340,
      title: "Cristianismo llega a Abisinia",
      description: "Se establece la Iglesia en Etiopía.",
      tags: ["Misión"] },

    // === PÉRGAMO 300–400 ===
    { era: "pergamo", type: "point", year: 361,
      title: "Juliano el Apóstata",
      description: "Intenta restaurar el paganismo.",
      tags: ["Imperio"] },
    { era: "pergamo", type: "point", year: 370,
      title: "Basilio contra el arrianismo",
      description: "Defiende la doctrina trinitaria.",
      tags: ["Padres capadocios"] },
    { era: "pergamo", type: "point", year: 380,
      title: "Cristianismo religión oficial",
      description: "Edicto de Tesalónica de Teodosio I.",
      tags: ["Iglesia y Estado"] },
    { era: "pergamo", type: "point", year: 395,
      title: "División del Imperio romano",
      description: "Separación definitiva entre Oriente y Occidente.",
      tags: ["Imperio romano"] },

    // === TIATIRA 400–1000 ===
    { era: "tiatira", type: "movement", startYear: 900, endYear: 1100,
      title: "Lombardos cristianos",
      description: "Grupos lombardos con énfasis bíblico previo a la Reforma.",
      tags: ["Movimiento"] },
    { era: "tiatira", type: "movement", startYear: 900, endYear: 1200,
      title: "Paulicianos tardíos",
      description: "Resto de los paulicianos en Asia Menor y los Balcanes.",
      tags: ["Movimiento"] },
    { era: "tiatira", type: "movement", startYear: 1000, endYear: 1300,
      title: "Albigenses / Cátaros",
      description: "Movimiento dualista muy fuerte en el sur de Francia.",
      tags: ["Movimiento"] },

    { era: "tiatira", type: "point", year: 532,
      title: "Santa Sofía en Constantinopla",
      description: "Construcción de la gran basílica de Justiniano.",
      tags: ["Arquitectura"] },
    { era: "tiatira", type: "point", year: 568,
      title: "Lombardos invaden Italia",
      description: "Los lombardos ocupan gran parte de la península.",
      tags: ["Invasiones"] },
    { era: "tiatira", type: "point", year: 570,
      title: "Nacimiento de Mahoma",
      description: "En La Meca; origen del islam histórico.",
      tags: ["Islam"] },
    { era: "tiatira", type: "point", year: 590,
      title: "Islam domina el Medio Oriente (proceso)",
      description: "Expansión rápida desde Arabia sobre Siria, Palestina y Persia.",
      tags: ["Islam"] },
    { era: "tiatira", type: "point", year: 622,
      title: "Hégira de Mahoma",
      description: "Huida de Mahoma a Medina; año 1 del calendario islámico.",
      tags: ["Islam"] },
    { era: "tiatira", type: "point", year: 622,
      title: "Impresión de libros en China (madera)",
      description: "Uso de bloques de madera para impresión a gran escala.",
      tags: ["Tecnología"] },
    { era: "tiatira", type: "point", year: 640,
      title: "Musulmanes conquistan el Medio Oriente",
      description: "Control de Siria, Palestina y Egipto.",
      tags: ["Islam"] },
    { era: "tiatira", type: "point", year: 643,
      title: "Cúpula de la Roca (inicio)",
      description: "Se inicia la construcción del santuario en Jerusalén.",
      tags: ["Arquitectura", "Islam"] },
    { era: "tiatira", type: "point", year: 715,
      title: "Árabes entran a España y Portugal",
      description: "Conquista musulmana de la Península Ibérica.",
      tags: ["Islam en Europa"] },
    { era: "tiatira", type: "point", year: 732,
      title: "Batalla de Tours",
      description: "Carlos Martel detiene el avance musulmán en Francia.",
      tags: ["Europa"] },
    { era: "tiatira", type: "point", year: 730,
      title: "Beda escribe historia eclesiástica",
      description: "‘Historia eclesiástica del pueblo inglés’.",
      tags: ["Historia de la Iglesia"] },
    { era: "tiatira", type: "point", year: 725,
      title: "Controversia de los iconoclastas",
      description: "Debate sobre uso de imágenes en Oriente.",
      tags: ["Teología"] },
    { era: "tiatira", type: "point", year: 790,
      title: "Vikingos invaden Europa (790–870)",
      description: "Oleadas de incursiones desde Escandinavia.",
      tags: ["Invasiones"] },
    { era: "tiatira", type: "point", year: 796,
      title: "Alcuino revisa la Vulgata",
      description: "Revisión del texto bíblico latino para Carlomagno.",
      tags: ["Biblia"] },
    { era: "tiatira", type: "point", year: 800,
      title: "Carlomagno coronado emperador",
      description: "Renovatio imperii en Occidente.",
      tags: ["Imperio franco"] },
    { era: "tiatira", type: "point", year: 962,
      title: "Otón I, emperador del Sacro Imperio",
      description: "Se consolida el Sacro Imperio Romano Germánico.",
      tags: ["Imperio"] },
    { era: "tiatira", type: "point", year: 979,
      title: "China unificada bajo la dinastía Song",
      description: "Gran florecimiento económico y cultural.",
      tags: ["China"] },
    { era: "tiatira", type: "point", year: 1000,
      title: "Cumbre de la civilización maya en Yucatán",
      description: "Apogeo de ciudades mayas tardías.",
      tags: ["Culturas de América"] },
    { era: "tiatira", type: "point", year: 1054,
      title: "Gran Cisma de Oriente y Occidente",
      description: "Ruptura formal entre las iglesias de Constantinopla y Roma.",
      tags: ["Cisma"] },
    { era: "tiatira", type: "point", year: 1066,
      title: "Guillermo el Conquistador rey de Inglaterra",
      description: "Batalla de Hastings; nueva dinastía normanda.",
      tags: ["Inglaterra"] },

    // === SARDIS 1100–1400 ===
    { era: "sardis", type: "movement", startYear: 1100, endYear: 1300,
      title: "Albigenses / Cátaros",
      description: "Movimiento disidente en el sur de Francia.",
      tags: ["Movimiento"] },
    { era: "sardis", type: "movement", startYear: 1400, endYear: 1450,
      title: "Husitas",
      description: "Seguidores de Jan Hus en Bohemia.",
      tags: ["Movimiento"] },

    { era: "sardis", type: "point", year: 1096,
      title: "Primera cruzada",
      description: "Convocada por Urbano II para recuperar Jerusalén.",
      tags: ["Cruzadas"] },
    { era: "sardis", type: "point", year: 1147,
      title: "Segunda cruzada",
      description: "Responde a la caída de Edesa.",
      tags: ["Cruzadas"] },
    { era: "sardis", type: "point", year: 1188,
      title: "Tercera cruzada",
      description: "Cruzada de Ricardo Corazón de León y otros reyes.",
      tags: ["Cruzadas"] },
    { era: "sardis", type: "point", year: 1202,
      title: "Cuarta cruzada",
      description: "Termina saqueando Constantinopla (1204).",
      tags: ["Cruzadas"] },
    { era: "sardis", type: "point", year: 1150,
      title: "Universidades de Oxford y París",
      description: "Nacen los grandes centros universitarios medievales.",
      tags: ["Universidades"] },
    { era: "sardis", type: "point", year: 1170,
      title: "Asesinato de Tomás Becket",
      description: "Conflicto entre el arzobispo y el rey Enrique II.",
      tags: ["Inglaterra"] },
    { era: "sardis", type: "point", year: 1215,
      title: "Carta Magna",
      description: "Limitación del poder real en Inglaterra.",
      tags: ["Derecho"] },
    { era: "sardis", type: "point", year: 1215,
      title: "Transubstanciación definida",
      description: "El IV Concilio de Letrán formula la doctrina.",
      tags: ["Teología sacramental"] },
    { era: "sardis", type: "point", year: 1265,
      title: "Suma Teológica de Tomás de Aquino",
      description: "Síntesis mayor de teología escolástica.",
      tags: ["Teología"] },
    { era: "sardis", type: "point", year: 1266,
      title: "Nacimiento del pintor Giotto",
      description: "Figura clave del proto-renacimiento italiano.",
      tags: ["Arte"] },
    { era: "sardis", type: "point", year: 1384,
      title: "Biblia de Wycliffe",
      description: "Traducción inglesa de la Biblia; anticipa la Reforma.",
      tags: ["Biblia"] },
    { era: "sardis", type: "point", year: 1415,
      title: "Martirio de Juan Hus",
      description: "Reformador checo condenado en Constanza.",
      tags: ["Pre-Reforma"] },
    { era: "sardis", type: "point", year: 1418,
      title: "Tomás de Kempis: Imitación de Cristo",
      description: "Devocional clásico de la espiritualidad medieval.",
      tags: ["Espiritualidad"] },
    { era: "sardis", type: "point", year: 1440,
      title: "Gutenberg y la imprenta",
      description: "Desarrollo de la imprenta de tipos móviles.",
      tags: ["Tecnología"] },
    { era: "sardis", type: "point", year: 1453,
      title: "Caída de Constantinopla",
      description: "Los turcos otomanos conquistan la capital bizantina.",
      tags: ["Imperio bizantino"] },
    { era: "sardis", type: "point", year: 1479,
      title: "Inquisición española",
      description: "Se institucionaliza bajo los Reyes Católicos.",
      tags: ["Inquisición"] },
    { era: "sardis", type: "point", year: 1494,
      title: "Savonarola contra la inmoralidad papal",
      description: "Predicador dominico en Florencia.",
      tags: ["Reforma moral"] },

    // === FILADELFIA 1500–1800 ===
    { era: "filadelfia", type: "movement", startYear: 1517, endYear: 1564,
      title: "Reforma: Lutero, Zwinglio, Calvino",
      description: "Núcleo de la Reforma protestante clásica.",
      tags: ["Reforma"] },
    { era: "filadelfia", type: "movement", startYear: 1525, endYear: 1700,
      title: "Anabautistas y menonitas",
      description: "Movimientos de bautismo de creyentes y vida comunitaria.",
      tags: ["Movimiento"] },
    { era: "filadelfia", type: "movement", startYear: 1600, endYear: 1800,
      title: "Pietismo y avivamientos",
      description: "Enfatizan santidad personal y misión.",
      tags: ["Pietismo"] },

    { era: "filadelfia", type: "point", year: 1516,
      title: "Nuevo Testamento de Erasmo",
      description: "Edición crítica griega que facilita traducciones bíblicas.",
      tags: ["Biblia"] },
    { era: "filadelfia", type: "point", year: 1530,
      title: "Iglesia luterana",
      description: "Confesión de Augsburgo y consolidación luterana.",
      tags: ["Denominaciones"] },
    { era: "filadelfia", type: "point", year: 1541,
      title: "Iglesia congregacionalista",
      description: "Énfasis en la autonomía de cada congregación.",
      tags: ["Denominaciones"] },
    { era: "filadelfia", type: "point", year: 1568,
      title: "Derrota de la Armada española",
      description: "Inglaterra se consolida como potencia marítima protestante.",
      tags: ["Europa"] },
    { era: "filadelfia", type: "point", year: 1572,
      title: "Matanza de San Bartolomé",
      description: "Masacre de hugonotes en Francia.",
      tags: ["Persecución"] },
    { era: "filadelfia", type: "point", year: 1603,
      title: "Iglesia presbiteriana",
      description: "Sistema de gobierno por ancianos; fuerte en Escocia.",
      tags: ["Denominaciones"] },
    { era: "filadelfia", type: "point", year: 1629,
      title: "Descartes y el racionalismo",
      description: "Inicio formal de la filosofía moderna.",
      tags: ["Filosofía"] },
    { era: "filadelfia", type: "point", year: 1665,
      title: "Newton y la gravedad",
      description: "Experimentos que desembocan en la ley de gravitación universal.",
      tags: ["Ciencia"] },
    { era: "filadelfia", type: "point", year: 1700,
      title: "Grandes misioneros protestantes",
      description: "Edwards, Wesley, Whitefield, Carey, Judson, Newton, Müller, Taylor, Moody, Spurgeon, Livingstone, entre otros.",
      tags: ["Misión", "Avivamiento"] },
    { era: "filadelfia", type: "point", year: 1859,
      title: "Darwin publica 'El origen de las especies'",
      description: "Teoría de la evolución con impacto en la teología.",
      tags: ["Ciencia", "Debate fe–ciencia"] },

    // === LAODICEA 1900–2025 ===
    { era: "laodicea", type: "point", year: 1914,
      title: "Primera guerra mundial",
      description: "Conflicto global que reordena Europa y el Medio Oriente.",
      tags: ["Guerras mundiales"] },
    { era: "laodicea", type: "point", year: 1939,
      title: "Segunda guerra mundial",
      description: "Devastación global, Holocausto y uso de armas atómicas.",
      tags: ["Guerras mundiales"] },
    { era: "laodicea", type: "point", year: 1948,
      title: "Fundación del Estado de Israel",
      description: "Establecimiento moderno del estado judío.",
      tags: ["Israel"] },
    { era: "laodicea", type: "point", year: 1950,
      title: "Billy Graham y cruzadas masivas",
      description: "Evangelismo mundial con grandes campañas.",
      tags: ["Evangelismo"] },
    { era: "laodicea", type: "point", year: 1960,
      title: "Movimiento misionero moderno",
      description: "Expansión de misiones a pueblos no alcanzados.",
      tags: ["Misión"] },
    { era: "laodicea", type: "point", year: 1970,
      title: "Iglesia evangélica globalizada",
      description: "Crecimiento fuerte en el Sur Global.",
      tags: ["Iglesia contemporánea"] }
  ];

  // ---------- RENDER ----------

  const eras = Array.from(document.querySelectorAll(".era"));
  const detailPanel = document.getElementById("detailPanel");

  // Agrupar eventos por era y por tipo
  const eventsByEra = {};
  events.forEach(ev => {
    if (!eventsByEra[ev.era]) eventsByEra[ev.era] = { movements: [], points: [] };
    if (ev.type === "movement") eventsByEra[ev.era].movements.push(ev);
    else eventsByEra[ev.era].points.push(ev);
  });

  eras.forEach(eraEl => {
    const key = eraEl.dataset.era;
    const start = Number(eraEl.dataset.start);
    const end = Number(eraEl.dataset.end);
    const range = end - start;

    const layerMov = eraEl.querySelector(".layer--movements");
    const layerEvt = eraEl.querySelector(".layer--events");
    const ruler = eraEl.querySelector(".ruler");

    // Regla inferior: ticks cada 50 años dentro del rango
    if (ruler) {
      const firstTick = Math.ceil(start / 50) * 50;
      for (let y = firstTick; y <= end; y += 50) {
        const t = document.createElement("div");
        t.className = "ruler-tick";
        const leftPercent = ((y - start) / range) * 100;
        t.style.left = leftPercent + "%";
        t.innerHTML = `<span>${y}</span>`;
        ruler.appendChild(t);
      }
    }

    const data = eventsByEra[key];
    if (!data) return;

    // Lógica de “filas” verticales: 5 para movimientos, 7 para eventos
    const movementLanes = 5;
    const eventLanes = 7;

    const placeEvents = (items, layer, lanesCount, isMovement) => {
      if (!layer) return;
      const sorted = items.slice().sort((a, b) => {
        const aYear = isMovement ? a.startYear : a.year;
        const bYear = isMovement ? b.startYear : b.year;
        return aYear - bYear;
      });

      sorted.forEach((ev, idx) => {
        const laneIndex = idx % lanesCount;
        const topPercent = ((laneIndex + 1) / (lanesCount + 1)) * 100;

        let leftPercent;
        let widthPercent = null;

        if (isMovement) {
          const s = Math.max(ev.startYear, start);
          const e = Math.min(ev.endYear, end);
          const effectiveRange = e - s;
          leftPercent = ((s - start) / range) * 100;
          widthPercent = (effectiveRange / range) * 100;
        } else {
          leftPercent = ((ev.year - start) / range) * 100;
        }

        const el = document.createElement("div");
        el.className = "event" + (isMovement ? " event--movement" : "");
        el.style.left = leftPercent + "%";
        el.style.top = topPercent + "%";
        if (widthPercent !== null) el.style.width = Math.max(widthPercent, 4) + "%";

        const labelYear = isMovement
          ? `${ev.startYear}–${ev.endYear}`
          : ev.year;
        el.textContent = `${labelYear} · ${ev.title}`;

        el.addEventListener("click", () => {
          const tagsHtml = (ev.tags || [])
            .map(t => `<span class="tag">${t}</span>`)
            .join("");
          detailPanel.innerHTML = `
            <div class="detail-card">
              <h4>${ev.title}</h4>
              <p>${ev.description || ""}</p>
              <div>${tagsHtml}</div>
            </div>`;
        });

        layer.appendChild(el);
      });
    };

    placeEvents(data.movements, layerMov, movementLanes, true);
    placeEvents(data.points, layerEvt, eventLanes, false);
  });
</script>

</body>
</html>
